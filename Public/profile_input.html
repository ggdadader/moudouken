<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="zh-TW"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;title&gt;品味旅遊助手 - 建立個人檔案&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>/* 簡單的 CSS 美化 */</p>
<p class="p1"><span class="Apple-converted-space">        </span>body {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #f4f7f6;</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>justify-content: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>min-height: 100vh;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 0;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.container {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 2rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 12px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 4px 15px rgba(0,0,0,0.1);</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>max-width: 500px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>h2 {</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #333;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.form-group {</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>label.field-label {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: block;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 0.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #555;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>input[type="text"] {</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid #ddd;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 6px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-sizing: border-box;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.checkbox-group {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex-direction: column;</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 8px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #f9f9f9;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 6px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.checkbox-item {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.checkbox-item input {</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-right: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: scale(1.2);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>button {</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 12px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #007bff;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 6px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: background 0.3s;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>button:hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #0056b3;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>button:disabled {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #ccc;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: not-allowed;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>#statusMessage {</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 0.9rem;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.success { color: green; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.error { color: red; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;div class="container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;h2&gt;建立您的品味檔案&lt;/h2&gt;</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;form id="profileForm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="form-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;label class="field-label" for="nickname"&gt;暱稱 (Nickname)&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;input type="text" id="nickname" name="nickname" placeholder="請輸入您的暱稱" required&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="form-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;label class="field-label"&gt;旅遊偏好 (Travel Preferences)&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="checkbox-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;label class="checkbox-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="checkbox" name="travel_prefs" value="都市漫步"&gt; 都市漫步</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;label class="checkbox-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="checkbox" name="travel_prefs" value="歷史古蹟"&gt; 歷史古蹟</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;label class="checkbox-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="checkbox" name="travel_prefs" value="戶外探險"&gt; 戶外探險</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="form-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;label class="field-label"&gt;藝術偏好 (Art Preferences)&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="checkbox-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;label class="checkbox-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="checkbox" name="art_prefs" value="ACG-科幻"&gt; ACG-科幻</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;label class="checkbox-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="checkbox" name="art_prefs" value="現代藝術"&gt; 現代藝術</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;label class="checkbox-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;input type="checkbox" name="art_prefs" value="電影-獨立製片"&gt; 電影-獨立製片</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button type="submit" id="submitBtn"&gt;儲存 Profile&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/form&gt;</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="statusMessage"&gt;&lt;/div&gt;</p>
<p class="p1">&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;script type="module"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>// 引入 Firebase 函式庫 (使用 CDN)</p>
<p class="p1"><span class="Apple-converted-space">    </span>import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";</p>
<p class="p1"><span class="Apple-converted-space">    </span>import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// -----------------------------------------------------------</p>
<p class="p1"><span class="Apple-converted-space">    </span>// TODO: 請在此處填入您的 Firebase 專案配置資訊 (非常重要！)</p>
<p class="p1"><span class="Apple-converted-space">    </span>// -----------------------------------------------------------</p>
<p class="p1"><span class="Apple-converted-space">    </span>// For Firebase JS SDK v7.20.0 and later, measurementId is optional</p>
<p class="p1">const firebaseConfig = {</p>
<p class="p1"><span class="Apple-converted-space">  </span>apiKey: "AIzaSyDLH0QU1G_mVos9WbvmqwZl0Fm-yh_-m64",</p>
<p class="p1"><span class="Apple-converted-space">  </span>authDomain: "moudouken.firebaseapp.com",</p>
<p class="p1"><span class="Apple-converted-space">  </span>projectId: "moudouken",</p>
<p class="p1"><span class="Apple-converted-space">  </span>storageBucket: "moudouken.firebasestorage.app",</p>
<p class="p1"><span class="Apple-converted-space">  </span>messagingSenderId: "72234130648",</p>
<p class="p1"><span class="Apple-converted-space">  </span>appId: "1:72234130648:web:222bb9de00befe0a0d0bad",</p>
<p class="p1"><span class="Apple-converted-space">  </span>measurementId: "G-3CW2C5QCRD"</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// 初始化 Firebase</p>
<p class="p1"><span class="Apple-converted-space">    </span>let app;</p>
<p class="p1"><span class="Apple-converted-space">    </span>let db;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>try {</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (!firebaseConfig.apiKey) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>console.warn("尚未設定 firebaseConfig，請在程式碼中填入配置資訊。");</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('statusMessage').innerHTML = '&lt;span class="error"&gt;錯誤：請先在程式碼中設定 Firebase Config&lt;/span&gt;';</p>
<p class="p1"><span class="Apple-converted-space">        </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">            </span>app = initializeApp(firebaseConfig);</p>
<p class="p1"><span class="Apple-converted-space">            </span>db = getFirestore(app);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>} catch (e) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>console.error("Firebase 初始化失敗", e);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// 處理表單提交</p>
<p class="p1"><span class="Apple-converted-space">    </span>const profileForm = document.getElementById('profileForm');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const submitBtn = document.getElementById('submitBtn');</p>
<p class="p1"><span class="Apple-converted-space">    </span>const statusMessage = document.getElementById('statusMessage');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>profileForm.addEventListener('submit', async (e) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>e.preventDefault(); // 防止頁面重新整理</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>if (!db) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>alert("資料庫尚未連結，請檢查程式碼設定。");</p>
<p class="p1"><span class="Apple-converted-space">            </span>return;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// 1. 鎖定按鈕避免重複提交</p>
<p class="p1"><span class="Apple-converted-space">        </span>submitBtn.disabled = true;</p>
<p class="p1"><span class="Apple-converted-space">        </span>submitBtn.textContent = "儲存中...";</p>
<p class="p1"><span class="Apple-converted-space">        </span>statusMessage.textContent = "";</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// 2. 收集資料</p>
<p class="p1"><span class="Apple-converted-space">        </span>const nickname = document.getElementById('nickname').value;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// 取得勾選的「旅遊偏好」並轉為 Array</p>
<p class="p1"><span class="Apple-converted-space">        </span>const travelCheckboxes = document.querySelectorAll('input[name="travel_prefs"]:checked');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const travelPrefsArray = Array.from(travelCheckboxes).map(cb =&gt; cb.value);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// 取得勾選的「藝術偏好」並轉為 Array</p>
<p class="p1"><span class="Apple-converted-space">        </span>const artCheckboxes = document.querySelectorAll('input[name="art_prefs"]:checked');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const artPrefsArray = Array.from(artCheckboxes).map(cb =&gt; cb.value);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// 準備寫入的資料物件</p>
<p class="p1"><span class="Apple-converted-space">        </span>const userProfileData = {</p>
<p class="p1"><span class="Apple-converted-space">            </span>nickname: nickname,</p>
<p class="p1"><span class="Apple-converted-space">            </span>travel_prefs: travelPrefsArray,</p>
<p class="p1"><span class="Apple-converted-space">            </span>art_prefs: artPrefsArray,</p>
<p class="p1"><span class="Apple-converted-space">            </span>created_at: new Date()</p>
<p class="p1"><span class="Apple-converted-space">        </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>try {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// 3. 寫入 Firebase Firestore 到 'User_Profiles' 集合</p>
<p class="p1"><span class="Apple-converted-space">            </span>const docRef = await addDoc(collection(db, 'User_Profiles'), userProfileData);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>console.log("Document written with ID: ", docRef.id);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// 4. 成功回饋</p>
<p class="p1"><span class="Apple-converted-space">            </span>statusMessage.innerHTML = '&lt;span class="success"&gt;儲存成功！資料 ID: ' + docRef.id + '&lt;/span&gt;';</p>
<p class="p1"><span class="Apple-converted-space">            </span>profileForm.reset(); // 清空表單</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>console.error("Error adding document: ", error);</p>
<p class="p1"><span class="Apple-converted-space">            </span>statusMessage.innerHTML = '&lt;span class="error"&gt;儲存失敗：' + error.message + '&lt;/span&gt;';</p>
<p class="p1"><span class="Apple-converted-space">        </span>} finally {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// 5. 恢復按鈕狀態</p>
<p class="p1"><span class="Apple-converted-space">            </span>submitBtn.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">            </span>submitBtn.textContent = "儲存 Profile";</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p1">&lt;/script&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
