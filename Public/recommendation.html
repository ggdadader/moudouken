<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="zh-TW"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;title&gt;å“å‘³æ—…éŠåŠ©æ‰‹ - æ¨è–¦çµæœ&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/* åŸºç¤ CSS æ²¿ç”¨ Profile é é¢é¢¨æ ¼ */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>body {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>background-color: #f4f7f6;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>justify-content: center;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>align-items: flex-start; /* èª¿æ•´ç‚ºå¾é ‚éƒ¨é–‹å§‹æ’åˆ— */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>min-height: 100vh;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>margin: 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.container {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>background-color: white;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>padding: 2rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>border-radius: 12px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>box-shadow: 0 4px 15px rgba(0,0,0,0.1);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>max-width: 700px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>h2 {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>color: #333;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>margin-bottom: 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.search-group {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>gap: 10px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>margin-bottom: 20px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>input[type="text"] {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>flex-grow: 1;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>padding: 10px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>border: 1px solid #ddd;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>border-radius: 6px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>font-size: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>button {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>padding: 10px 15px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>background-color: #007bff;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>border: none;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>border-radius: 6px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>transition: background 0.3s;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>button:hover {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>background-color: #0056b3;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/* æ¨è–¦çµæœåˆ—è¡¨æ¨£å¼ */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>#recommendationsList {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>list-style: none;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>padding: 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.recommendation-item {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>border: 1px solid #eee;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>border-radius: 8px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>padding: 15px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>margin-bottom: 10px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>background-color: #f9f9f9;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.recommendation-item h3 {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>margin-top: 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>color: #333;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.tags {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>font-size: 0.85rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>color: #6c757d;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.match-score {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>color: green;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;div class="container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;h2&gt;ğŸ¯ å“å‘³æ¨è–¦çµæœ&lt;/h2&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="search-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;input type="text" id="locationInput" placeholder="è«‹è¼¸å…¥æ—…éŠåœ°é» (ä¾‹å¦‚: æ±äº¬)" value="æ±äº¬"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;button id="searchBtn"&gt;é–‹å§‹æ¨è–¦&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div id="statusMessage"&gt;&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;h3&gt;æ¨è–¦æ™¯é»èˆ‡æ´»å‹•ï¼š&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;ul id="recommendationsList"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/ul&gt;</p>
<p class="p1">&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;script type="module"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// å¼•å…¥ Firebase å‡½å¼åº«</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>import { getFirestore, collection, getDocs, query, where } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// -----------------------------------------------------------</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// TODO: è«‹åœ¨æ­¤è™•å¡«å…¥æ‚¨çš„ Firebase å°ˆæ¡ˆé…ç½®è³‡è¨Šï¼ (èˆ‡ profile_input.html ç›¸åŒ)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// -----------------------------------------------------------</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// For Firebase JS SDK v7.20.0 and later, measurementId is optional</p>
<p class="p1">const firebaseConfig = {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>apiKey: "AIzaSyDLH0QU1G_mVos9WbvmqwZl0Fm-yh_-m64",</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>authDomain: "moudouken.firebaseapp.com",</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>projectId: "moudouken",</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>storageBucket: "moudouken.firebasestorage.app",</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>messagingSenderId: "72234130648",</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>appId: "1:72234130648:web:222bb9de00befe0a0d0bad",</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>measurementId: "G-3CW2C5QCRD"</p>
<p class="p1">};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// åˆå§‹åŒ– Firebase</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>let app;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>let db;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>try {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (firebaseConfig.apiKey) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>app = initializeApp(firebaseConfig);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>db = getFirestore(app);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>console.warn("å°šæœªè¨­å®š firebaseConfigã€‚");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>} catch (e) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>console.error("Firebase åˆå§‹åŒ–å¤±æ•—", e);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// é€™è£¡æˆ‘å€‘æš«æ™‚ç”¨ç¡¬ç·¨ç¢¼çš„æ¨™ç±¤ä¾†æ¨¡æ“¬ç”¨æˆ¶çš„å“å‘³</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// **æ³¨æ„ï¼šåœ¨é€²éšç‰ˆæœ¬ä¸­ï¼Œæˆ‘å€‘éœ€è¦ä¿®æ”¹é€™è£¡ä¾†è®€å– Firestore ä¸­çš„ User_Profiles è³‡æ–™**</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const USER_PREFS_TAGS = ['ACG-ç§‘å¹»', 'ç¾ä»£è—è¡“', 'éƒ½å¸‚æ¼«æ­¥'];<span class="Apple-converted-space">Â </span></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const searchBtn = document.getElementById('searchBtn');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const locationInput = document.getElementById('locationInput');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const recommendationsList = document.getElementById('recommendationsList');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const statusMessage = document.getElementById('statusMessage');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// --- æ ¸å¿ƒæ¨è–¦é‚è¼¯ï¼šå¾ Firestore è®€å–ä¸¦åŒ¹é…æ¨™ç±¤ ---</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>async function fetchAndRecommend(location) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>recommendationsList.innerHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>statusMessage.innerHTML = 'æœå°‹ä¸­...';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>searchBtn.disabled = true;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (!db) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>statusMessage.innerHTML = '&lt;span class="error"&gt;éŒ¯èª¤ï¼šè³‡æ–™åº«æœªé€£æ¥ã€‚&lt;/span&gt;';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>searchBtn.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>try {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// 1. å»ºç«‹æŸ¥è©¢ï¼šå…ˆç¯©é¸åœ°é»</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// POI é›†åˆåç¨±ï¼š'Points_of_Interest'</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const poiCollection = collection(db, 'Points_of_Interest');</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// å‰µå»ºæŸ¥è©¢ï¼šåªæœå°‹åœ°é»ç›¸ç¬¦çš„ POI</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const locationQuery = query(</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>poiCollection,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>where('åœ°é»', '==', location) // æ¬„ä½åç¨±è¦èˆ‡æ‚¨çš„ POI é›†åˆå®Œå…¨åŒ¹é…</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const querySnapshot = await getDocs(locationQuery);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const allLocationPOIs = [];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>querySnapshot.forEach((doc) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>allLocationPOIs.push({ id: doc.id, ...doc.data() });</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// 2. å¯¦ä½œæ¨™ç±¤åŒ¹é…é‚è¼¯</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const recommendedPOIs = [];</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>allLocationPOIs.forEach(poi =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>let matchCount = 0;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// ç¢ºä¿ POI çš„ 'å…§å®¹æ¨™ç±¤' æ¬„ä½æ˜¯é™£åˆ—</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (Array.isArray(poi.å…§å®¹æ¨™ç±¤)) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>poi.å…§å®¹æ¨™ç±¤.forEach(poiTag =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// æª¢æŸ¥ POI æ¨™ç±¤æ˜¯å¦åœ¨ç”¨æˆ¶åå¥½æ¨™ç±¤åˆ—è¡¨ USER_PREFS_TAGS ä¸­</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (USER_PREFS_TAGS.includes(poiTag)) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>matchCount++;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// å¦‚æœè‡³å°‘åŒ¹é…åˆ°ä¸€å€‹æ¨™ç±¤ï¼Œå‰‡å°‡å…¶åŠ å…¥æ¨è–¦åˆ—è¡¨</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (matchCount &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>recommendedPOIs.push({<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>...poi,<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>matchScore: matchCount // ä»¥åŒ¹é…æ¨™ç±¤æ•¸é‡ä½œç‚ºåˆ†æ•¸</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// 3. æ’åºèˆ‡é¡¯ç¤ºçµæœ</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// ä¾åŒ¹é…åˆ†æ•¸ç”±é«˜åˆ°ä½æ’åº</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>recommendedPOIs.sort((a, b) =&gt; b.matchScore - a.matchScore);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (recommendedPOIs.length === 0) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>statusMessage.innerHTML = `&lt;span style="color:#ff6600;"&gt;åœ¨ ${location} æ‰¾ä¸åˆ°ç¬¦åˆæ‚¨å“å‘³ (${USER_PREFS_TAGS.join(', ')}) çš„æ´»å‹•/æ™¯é»ã€‚&lt;/span&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>recommendedPOIs.forEach(poi =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const listItem = document.createElement('li');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>listItem.className = 'recommendation-item';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>listItem.innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h3&gt;${poi.åç¨±} (${poi.åœ°é»})&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p class="tags"&gt;æ¨™ç±¤: ${poi.å…§å®¹æ¨™ç±¤ ? poi.å…§å®¹æ¨™ç±¤.join(', ') : 'ç„¡'}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p class="match-score"&gt;å“å‘³åŒ¹é…åº¦: ${poi.matchScore} å€‹æ¨™ç±¤&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>recommendationsList.appendChild(listItem);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>statusMessage.innerHTML = `&lt;span class="success"&gt;æˆåŠŸæ‰¾åˆ° ${recommendedPOIs.length} å€‹æ¨è–¦é …ç›®ï¼&lt;/span&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>console.error("æœå°‹æ¨è–¦æ™‚ç™¼ç”ŸéŒ¯èª¤: ", error);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>statusMessage.innerHTML = `&lt;span class="error"&gt;è³‡æ–™è®€å–å¤±æ•—ï¼Œè«‹æª¢æŸ¥ Firestore é€£ç·šå’Œè¦å‰‡ã€‚&lt;/span&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>} finally {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>searchBtn.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>searchBtn.textContent = 'é‡æ–°æ¨è–¦';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// äº‹ä»¶ç›£è½ï¼šæŒ‰ä¸‹æŒ‰éˆ•æ™‚è§¸ç™¼æ¨è–¦</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>searchBtn.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const location = locationInput.value.trim();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (location) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>fetchAndRecommend(location);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>statusMessage.innerHTML = '&lt;span class="error"&gt;è«‹è¼¸å…¥æ—…éŠåœ°é»ï¼&lt;/span&gt;';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// é é¢åŠ è¼‰å¾Œè‡ªå‹•åŸ·è¡Œä¸€æ¬¡</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>fetchAndRecommend(locationInput.value.trim());</p>
<p class="p2"><br></p>
<p class="p1">&lt;/script&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
